mainwd <- "."
outputfolder <- "output/"
dir.create(file.path(mainwd, outputfolder), recursive = TRUE, showWarnings = FALSE)
setwd(file.path(mainwd, outputfolder))
counts <- fread("../../dat/YR-KDM5B.counts.txt")
colnames(counts) <- gsub("^([0-9])", "ko\\1", gsub("-", ".", gsub("\\.msd.*", "", basename(colnames(counts)))))
library(data.table)
library(ggplot2)
library(reshape2)
library(janitor)
counts <- fread("../../dat/YR-KDM5B.counts.txt")
colnames(counts) <- gsub("^([0-9])", "ko\\1", gsub("-", ".", gsub("\\.msd.*", "", basename(colnames(counts)))))
counts.summary <- fread("../../dat/YR-KDM5B.counts.txt.summary")
colnames(counts.summary) <- gsub("^([0-9])", "ko\\1", gsub("-", ".", gsub("\\.msd.*", "", basename(colnames(counts.summary)))))
#### Get RPKM ####
# counts.summary.total <- adorn_totals(counts.summary, where = "row")
# fwrite(counts.summary.total, "totals.test.txt", sep = "\t")
counts.summary <- counts.summary[,.SD,.SDcols = 2:ncol(counts.summary)]
samples <- unique(gsub("_R.*", "", colnames(counts.summary)))
for(sam in samples){
if(!grepl("1G8|815|old", sam)){
counts.summary[, eval(paste0(sam, "_merge")) := get(paste0(sam, "_Rep1")) + get(paste0(sam, "_Rep2"))]
}
}
counts.summary.total <- colSums(counts.summary)/1e6
counts.ma <- as.matrix(counts[,.SD,.SDcols = 7:ncol(counts)])
