source('~/Google_Drive/personal/projects/github/zhang_nature_2021/scripts/190909_melanoma_salmon_git.R', echo=TRUE)
#### Correlation plots ####
gene1 <- "KDM5B"
gene2 <- "ERVmap_2637"
vst.raw.dt.t.subset <- vst.raw.dt.t[,.SD,.SDcols = c(gene1,gene2)]
cor.res <- cor.test(vst.raw.dt.t.subset[,get(gene1)], vst.raw.dt.t.subset[,get(gene2)])
cor.res$p.value
mp <- ggplot(vst.raw.df.t.subset, aes_string(gene1, gene2)) +
geom_point() +
geom_smooth(method = "lm") +
annotate("text", 12.2, 10.4, hjust = 0, label = paste0("r2 = ", signif(cor.res$estimate,3), "\np = ", signif(cor.res$p.value,3))) +
theme_bw() +
scale_y_continuous(labels = scaleFUN) +
scale_x_continuous(labels = scaleFUN) +
theme(axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 16),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
panel.grid = element_blank(),
panel.border = element_rect(fill=NA, colour = "black", size=0.75),
text=element_text(family="Arial"))
mp
mp <- ggplot(vst.raw.dt.t.subset, aes_string(gene1, gene2)) +
geom_point() +
geom_smooth(method = "lm") +
annotate("text", 12.2, 10.4, hjust = 0, label = paste0("r2 = ", signif(cor.res$estimate,3), "\np = ", signif(cor.res$p.value,3))) +
theme_bw() +
scale_y_continuous(labels = scaleFUN) +
scale_x_continuous(labels = scaleFUN) +
theme(axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 16),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
panel.grid = element_blank(),
panel.border = element_rect(fill=NA, colour = "black", size=0.75),
text=element_text(family="Arial"))
mp
#### Correlation plots ####
gene1 <- "KDM5B"
gene2 <- "ERVmap_2637"
vst.raw.dt.t.subset <- vst.raw.dt.t[,.SD,.SDcols = c(gene1,gene2)]
cor.res <- cor.test(vst.raw.dt.t.subset[,get(gene1)], vst.raw.dt.t.subset[,get(gene2)])
mp <- ggplot(vst.raw.dt.t.subset, aes_string(gene1, gene2)) +
geom_point() +
geom_smooth(method = "lm") +
annotate("text", 12.2, 10.4, hjust = 0, label = paste0("r2 = ", signif(cor.res$estimate,3), "\np = ", signif(cor.res$p.value,3))) +
theme_bw() +
scale_y_continuous(labels = scaleFUN) +
scale_x_continuous(labels = scaleFUN) +
theme(axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 16),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
panel.grid = element_blank(),
panel.border = element_rect(fill=NA, colour = "black", size=0.75),
text=element_text(family="Arial"))
ggsave(paste0(gene1, "_v_", gene2, ".cor.pdf"), mp, width = 3.5, height = 3.5)
